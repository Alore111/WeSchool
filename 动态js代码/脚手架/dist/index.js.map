{"version":3,"file":"index.js","mappings":";;;;;;;;;;AAAA;;AAEA;;AAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA;;AAEA;AACA;AACA;AACA;AAGA;AACA;;AAGA;;;AAGA;AACA;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AAjCA;AAmCA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;;AAEA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AAAA;;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;AAAA;;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;;AAEA;;;AAGA;AAGA;AACA;AAAA;;AACA;AACA;AAGA;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AASA;AACA;AAFA;AAUA;AACA;AAFA;AAUA;AACA;AAFA;AAOA;AACA;AAFA;AAOA;AACA;AAFA;AAQA;AACA;AAFA;AASA;AACA;AAFA;AASA;AACA;AAFA;AASA;AACA;AAFA;AAQA;AACA;AAFA;AASA;AACA;AAFA;AASA;AACA;AAFA;AASA;AACA;AAFA;AASA;AACA;AAFA;AASA;AACA;AAFA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AAVA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AATA;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhCA;AAmCA;;AACA;;;AAGA;;AAIA;;;AAGA;;AAIA;;;AAGA;;AAIA;;;AAGA;;AAIA;;;AAGA;;AAIA;;;AAGA;AAvvBA;AA2vBA;AACA","sources":["webpack://test/./dist/index.js"],"sourcesContent":["function runCode(){\n    \r\nconst db = wx.cloud.database();\r\n\r\n  \n  \n  var Page = function(page){\n    return page\n  }\nreturn Page({\n  \n  parseTag(tag) {\n    let res = {\n        type1: \"tag\",\n        name: \"\",\n        voidElement: false,\n        // attrs: {},\n        children: [],\n    };\n    let tagMatch = tag.match(/<\\/?([^\\s]+?)[/\\s>]/);\n    if (tagMatch) {\n        // 标签名称为正则匹配的第2项\n        res.type1 = tagMatch[1];\n        if (tag.charAt(tag.length - 2) === \"/\") {\n            // 判断tag字符串倒数第二项是不是 / 设置为空标签。 例子：<img/>\n            res.voidElement = true;\n        }\n    }\n    // 匹配所有的标签正则\n    let classList = tag.match(/\\s([^'\"/\\s><]+?)\\s*?=\\s*?(\".*?\"|'.*?')/g);\n  \n    if (classList) {\n      let style = ''\n        for (let i = 0; i < classList.length; i++) {\n            // 去空格再以= 分隔字符串  得到['属性名称','属性值']\n   \n            let c = classList[i].split(\"=\");\n            // c[1] = c[1].replace(/\\s*/g, \"\")\n            c[0] = c[0].replace(/\\s*/g, \"\")\n            // 循环设置属性\n            var lengthc = 2\n            for(lengthc; lengthc < c.length ; lengthc++){\n              c[1] += \"=\" + c[lengthc]\n            }\n            let p = c[1].substring(1, c[1].length - 1)\n            try{\n              p = JSON.parse(c[1].substring(1, c[1].length - 1))\n            }catch(e){\n             \n            }\n  \n            if (c[1]) {\n              if(c[0] === ' style'){\n                style = p + style\n                res[c[0]] = style\n              }else{\n                res[c[0]] = p\n              }\n      \n            };\n  \n        }\n    }\n    return res;\n  },\n  \n  parse(html) {\n    var that = this;\n    let result = [];\n    let current;\n    let level = -1;\n    let arr = [];\n    let tagRE = /<[a-zA-Z\\-\\!\\/](?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])*>/g;\n    html.replace(tagRE, function (tag, index) {\n        // 判断第二个字符是不是'/'来判断是否open\n        let isOpen = tag.charAt(1) !== \"/\";\n        // 获取标签末尾的索引\n        let start = index + tag.length;\n        // 标签之前的文本信息\n        let text = html.slice(start, html.indexOf(\"<\", start));\n  \n        let parent;\n        if (isOpen) {\n            level++;\n            // 设置标签属性\n            current = that.parseTag(tag);\n            // 判断是否为文本信息，是就push一个text children  不等于'  '\n            if (!current.voidElement && text.trim()) {\n                current[\"text\"] = text\n            }\n            // 如果我们是根用户，则推送新的基本节点\n            if (level === 0) {\n                result.push(current);\n            }\n            // 判断有没有上层，有就push当前标签\n            parent = arr[level - 1];\n            if (parent) {\n                parent.children.push(current);\n            }\n            // console.log(current)\n            arr[level] = current;\n        }\n        // 如果不是开标签，或者是空元素：</div><img>\n        if (!isOpen || current.voidElement) {\n            // level--\n            level--;\n        }\n    });\n    // console.log(result)\n    return result;\n  \n  },\nsetdata: function setdata(dictData) {\n  \n  for(var i in dictData){\n    this.data[i] = dictData[i]\n  }\n  var html = `<view  class=\"containers\" style=\"background-size: 100% 100%; height: 100%; position: fixed; width: 100%; z-index: -1;\">  <image  class=\"bgc\" src=\"cloud://cloud1-6gtqj1v4873bad50.636c-cloud1-6gtqj1v4873bad50-1307814679/bgc.png\" style=\"height: 100%; width: 100%;\">   </image>  </view> <view  class=\"title\">  ${(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)<=7 ? `<view  class=\"model\" animation=\"${(typeof this.data.animationData === \"object\" ? JSON.stringify( this.data.animationData) : this.data.animationData)}\" style=\"background-color: white; border-radius: 50rpx; height: 700rpx; margin: 0rpx auto; position: relative; top: 30vh; width: 72%; z-index: 99;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <view  class=\"model-top\" style=\"align-items: center; background-color: rgba(234,129,113); border-radius: 50rpx 50rpx 0rpx 0rpx; color: white; display: flex; font-size: 32rpx; justify-content: center; padding: 30rpx 0rpx;;${this.data.dark === 'dark' ? '    filter: invert(0%) !important;  ' : ''}\"> ${(typeof this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].question === \"object\" ? JSON.stringify( this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].question) : this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].question)}  </view> <view  class=\"model-body \" style=\"display: flex; height: 47%; justify-content: center; margin-left: 20rpx; margin-right: 20rpx; margin-top: 22%;;model-body ${(typeof this.data.click === \"object\" ? JSON.stringify( this.data.click) : this.data.click)!=0?'model-body-true':''};${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <view  class=\"model-body-choose-1 \" bindtap=\"choose_ans\" id=\"1\" style=\"align-items: center; background-color: #b9cfeb; border-radius: 40rpx; box-sizing: border-box; color: white; display: flex; font-size: 40rpx; height: 100%; justify-content: center; margin: 0rpx 20rpx; padding: 10rpx; transition: all .5s; white-space: normal; width: 45%; word-wrap: break-word;;model-body-choose-1 ${(typeof this.data.click === \"object\" ? JSON.stringify( this.data.click) : this.data.click)==1?'model-body-choose-1-true':''};${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <text  class=\"model-body-choose-text \" style=\"text-align: center; transition: all .5s; width: 100%;;model-body-choose-text ${(typeof this.data.click === \"object\" ? JSON.stringify( this.data.click) : this.data.click)==1?'model-body-choose-text-1-true':''};${this.data.dark === 'dark' ? '    filter: invert(0%) !important;  ' : ''}\"> ${(typeof this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].answer[0] === \"object\" ? JSON.stringify( this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].answer[0]) : this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].answer[0])}  </text>  </view> <view  class=\"model-body-choose-2 \" bindtap=\"choose_ans\" id=\"2\" style=\"align-items: center; background-color: #b9cfeb; border-radius: 40rpx; box-sizing: border-box; color: white; display: flex; font-size: 40rpx; height: 100%; justify-content: center; margin: 0rpx 20rpx; padding: 10rpx; transition: all .5s; white-space: normal; width: 45%; word-wrap: break-word;;model-body-choose-2 ${(typeof this.data.click === \"object\" ? JSON.stringify( this.data.click) : this.data.click)==2?'model-body-choose-2-true':''};${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <text  class=\"model-body-choose-text \" style=\"text-align: center; transition: all .5s; width: 100%;;model-body-choose-text ${(typeof this.data.click === \"object\" ? JSON.stringify( this.data.click) : this.data.click)==2?'model-body-choose-text-2-true':''};${this.data.dark === 'dark' ? '    filter: invert(0%) !important;  ' : ''}\"> ${(typeof this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].answer[1] === \"object\" ? JSON.stringify( this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].answer[1]) : this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)].answer[1])}  </text>  </view>  </view> <view  class=\"model-bottom\" style=\"undefined;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <view  class=\"model-bottom2\" style=\"align-items: center; color: rgba(234,129,113); display: flex; justify-content: center; margin-top: 4%;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\"> ${(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1}/8  </view>  </view>  </view> ` : ``}<view  class=\"model-end\" style=\"background-color: rgba(234,129,113); border-radius: 20rpx; box-shadow: 2rpx 2rpx 2rpx rgba(234,129,113); color: white; display: ${(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)==0||(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)>=8?'none':'block'}; left: 210rpx; padding: 20rpx 0rpx; position: absolute; text-align: center; top: 90%; width: 45%; z-index: 999;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\" bindtap=\"choose_return\"> 上一题  </view> ${(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)<=6 ? `<view  class=\"model3\" animation=\"${(typeof this.data.animationData2 === \"object\" ? JSON.stringify( this.data.animationData2) : this.data.animationData2)}\" style=\"background-color: white; border-radius: 50rpx; height: 700rpx; left: 20%; margin: 0rpx auto; position: absolute; top: 32vh; width: 70%; z-index: 55;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <view  class=\"model-top\" style=\"align-items: center; background-color: rgba(234,129,113); border-radius: 50rpx 50rpx 0rpx 0rpx; color: white; display: flex; font-size: 32rpx; justify-content: center; padding: 30rpx 0rpx;;${this.data.dark === 'dark' ? '    filter: invert(0%) !important;  ' : ''}\"> ${(typeof this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].question === \"object\" ? JSON.stringify( this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].question) : this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].question)}  </view> <view  class=\"model-body\" style=\"display: flex; height: 47%; justify-content: center; margin-left: 20rpx; margin-right: 20rpx; margin-top: 22%;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <view  bindtouchstart=\"touchstartX\" class=\"model-body-choose-1 \" bindtap=\"choose_ans\" id=\"1\" style=\"align-items: center; background-color: #b9cfeb; border-radius: 40rpx; box-sizing: border-box; color: white; display: flex; font-size: 40rpx; height: 100%; justify-content: center; margin: 0rpx 20rpx; padding: 10rpx; transition: all .5s; white-space: normal; width: 45%; word-wrap: break-word;;model-body-choose-1 ${(typeof this.data.click === \"object\" ? JSON.stringify( this.data.click) : this.data.click)==1?'model-body-choose-1-true':''};${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <text  class=\"model-body-choose-text\" style=\"text-align: center; transition: all .5s; width: 100%;;${this.data.dark === 'dark' ? '    filter: invert(0%) !important;  ' : ''}\"> ${(typeof this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].answer[0] === \"object\" ? JSON.stringify( this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].answer[0]) : this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].answer[0])}  </text>  </view> <view  bindtouchstart=\"touchstartX\" class=\"model-body-choose-2\" bindtap=\"choose_ans\" id=\"2\" style=\"align-items: center; background-color: #b9cfeb; border-radius: 40rpx; box-sizing: border-box; color: white; display: flex; font-size: 40rpx; height: 100%; justify-content: center; margin: 0rpx 20rpx; padding: 10rpx; transition: all .5s; white-space: normal; width: 45%; word-wrap: break-word;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <text  class=\"model-body-choose-text\" style=\"text-align: center; transition: all .5s; width: 100%;;${this.data.dark === 'dark' ? '    filter: invert(0%) !important;  ' : ''}\"> ${(typeof this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].answer[1] === \"object\" ? JSON.stringify( this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].answer[1]) : this.data.li[(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1].answer[1])}  </text>  </view>  </view> <view  class=\"model-bottom\" style=\"undefined;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <view  class=\"model-bottom2\" style=\"align-items: center; color: rgba(234,129,113); display: flex; justify-content: center; margin-top: 4%;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\"> ${(typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)+1}/8  </view>  </view>  </view> ` : (typeof this.data.id_ === \"object\" ? JSON.stringify( this.data.id_) : this.data.id_)>=8 ? `<view  class=\"model2\" style=\"background-color: #74b9ff; border-radius: 50rpx; margin: 0rpx auto; padding-bottom: 30rpx; position: relative; top: 20vh; width: 72%;;${this.data.dark === 'dark' ? '    filter: invert(100%) !important;  ' : ''}\">  <canvas  type=\"2d\" class=\"model2_canvas\" id=\"shareCanvas\" style=\"background-color: #74b9ff; border-radius: 50rpx; height: 800rpx; width: 100%;;${this.data.dark === 'dark' ? '    filter: invert(0%) !important;      ' : ''}\">   </canvas> <!--  class=\"show\">  <view  class=\"imgs\">  <image  class=\"img\" src=\"../images/touxiang.png\" mode=\"widthFix\">   </image>  </view> <view  class=\"show_title\"> \r\n        您的mbti类型为\r\n         <text  class=\"show_title_text\"> ${(typeof this.data.MbtiType === \"object\" ? JSON.stringify( this.data.MbtiType) : this.data.MbtiType)}  </text>  </view> <view  class=\"show_body\">  <text  space=\"ensp\"> ${(typeof this.data.describe === \"object\" ? JSON.stringify( this.data.describe) : this.data.describe)}  </text>  </view>  </!--> <view  class=\"share\" bindtap=\"share\" style=\"background-color: #fff; border-radius: 30rpx; color: rgba(234,129,113); display: flex; justify-content: center; margin: 0 auto; margin-top: 30rpx; padding: 20rpx 0rpx; width: 70%;\"> 保存图片  </view> <view  class=\"share\" bindtap=\"return\" style=\"background-color: #fff; border-radius: 30rpx; color: rgba(234,129,113); display: flex; justify-content: center; margin: 0 auto; margin-top: 30rpx; padding: 20rpx 0rpx; width: 70%;\"> 返回首页  </view>  </view> ` : ``} </view> `\n  this.setData({html : this.parse(html)});\n},\n  \r\n\r\n  /**\r\n   * 页面的初始数据\r\n   */\r\n  data: {\r\n    li:[\r\n      {question:\"你通常\",answer:[\r\n        \"与人容易混熟\" , \"比较沉静或矜持\"\r\n      ]},\r\n      {question:\"按程序做事\",answer:[\r\n        \"合你心意\" , \"令你感到束缚\"\r\n      ]},\r\n      {question:\"哪些人更吸引你\",answer:[\r\n        \"一个思维敏捷及非常聪颖的人\" , \"实事求是，具有丰富常识的人\"\r\n      ]},\r\n      {question:\"你倾向于\",answer:[\r\n        \"重视感情多于逻辑\" , \"重视逻辑多于感情\"\r\n      ]},\r\n      {question:\"要作决定时，你认为最重要的是\",answer:[\r\n        \"据事实衡量\" , \"考虑他人的感受的意见\"\r\n      ]},   \r\n        {question:\"在一大群人当中，通常是\",answer:[\r\n        \"你介绍大家认识\" , \"别人介绍你\"\r\n      ]},    \r\n       {question:\"你通常做事多数是\",answer:[\r\n        \"你按当天的心情去做\" , \"照拟好的程序去做\"\r\n      ]},\r\n      {question:\"一般来说，你和哪些人比较合得来\",answer:[\r\n        \"富有想象力\" , \"现实的人\"\r\n      ]},\r\n    ],\r\n    res:[], // 存放答案\r\n    //选择的id\r\n    id_:0,\r\n    MbtiType:\"\",\r\n    describe:\"\",\r\n    click:0,\r\n    animationData: {},\r\n  },\r\n  touchstartX(e) {\r\n    console.log(e);\r\n    this.setdata({\r\n        currentIndex: e.currentTarget.id\r\n      });\r\n      console.log( e.currentTarget.id)\r\n      // 获取触摸Y坐标\r\n      this.recordY = e.touches[0].clientY;\r\n  },\r\n  test() {\r\n  console.log(\"test\");\r\n  var self = this;\r\n  var animation = wx.createAnimation({\r\n      duration: 300,\r\n      timingFunction: 'liner',\r\n  });\r\n    this.animation= animation;\r\n    this.animation.translateY(-280).rotate(-5).translateX(0).step(); //第一次动画 离开\r\n    this.animation.translateY(0).translateX(0).rotate(0).step();//第二次动画 复位\r\n    this.setdata({\r\n      animationData: this.animation.export()//.export清除动画\r\n    });\r\n    this.animation2= animation;\r\n    this.animation2.translateY(40).rotate(0).translateX(0).step(); //第一次动画 离开\r\n    this.animation2.translateY(-25).translateX(0).rotate(0).step();//第二次动画 复位\r\n    this.animation2.translateY(0).translateX(0).rotate(0).step();//第二次动画 复位\r\n    this.setdata({\r\n      animationData2: this.animation2.export()//.export清除动画\r\n    });\r\n  },\r\n  choose_ans(e){\r\n    console.log(e)\r\n    console.log(\"id:\",e.currentTarget.id);\r\n    this.setdata({\r\n      click:e.currentTarget.id\r\n    })\r\n    console.log(\"click:\",this.data.click);\r\n    this.test(); //这个函数是调用动画\r\n      \r\n      this.setdata({\r\n        click:0\r\n      })\r\n      console.log('定时器里面更新的click',this.data.click);\r\n      console.log(e.currentTarget.id,\"2222222\")\r\n     let index = Number(e.currentTarget.id)\r\n    let count = this.data.id_\r\n     if(count==0){\r\n      this.setdata({start:new Date().getTime()})\r\n     }\r\n    let res = this.data.res\r\n    res[count] = index\r\n    count = count +1\r\n    this.setdata({id_:count,idx:index})\r\n    \r\n    if(count==res.length){\r\n      let end =  new Date().getTime()\r\n      console.log(this.data.start)\r\n      let use_Time = end-this.data.start\r\n      console.log(use_Time)\r\n      this.setdata({use_Time})\r\n      this.process(res)\r\n    } \r\n    \r\n  },\r\n  choose_return(){\r\n    console.log('choose_return');\r\n    if(this.data.id_>0){\r\n      this.setdata({id_:this.data.id_-1})\r\n    }\r\n    \r\n  },\r\n  return(){\r\n    // wx.navigateTo({url:\"/pages/index/index\"})\r\n    wx.navigateBack({\r\n      delta: 1,\r\n    })\r\n  },\r\n  initcanvas(MbtiType,describe){\r\n    // wx.showLoading({\r\n    //   title: '生成中',\r\n    //   mask:true,\r\n    // })\r\n    \r\n    console.log(MbtiType);\r\n    console.log(describe);\r\n    let that =this;\r\n    let wpx = wx.getSystemInfoSync().windowWidth/375\r\n    // let iconurl = wx.getStorageSync('args').iconUrl;\r\n    const query = wx.createSelectorQuery()\r\n    // headerImg.src = iconurl;\r\n    query.select('#shareCanvas')\r\n    .fields({ node: true, size: true })\r\n    .exec((res) => {\r\n      const canvas = res[0].node\r\n      console.log(canvas)\r\n      const ctx = canvas.getContext('2d')\r\n      const dpr = wx.getSystemInfoSync().pixelRatio\r\n      console.log(canvas);\r\n      canvas.width = res[0].width * dpr\r\n      canvas.height = res[0].height * dpr\r\n      ctx.scale( dpr,dpr)\r\n      this.setdata({\r\n        ctx,canvas,wpx\r\n      })\r\n      console.log(canvas.width);\r\n      console.log(canvas.height);\r\n      console.log('初始化完成');\r\n      // this.draw(ctx,canvas,wpx)//开始画图\r\n      //背景色块\r\n      this.draw(ctx,canvas,wpx,dpr,MbtiType,describe)\r\n    })\r\n},\r\ndraw(ctx,canvas,wpx,dpr,MbtiType,describe){\r\n  let wxname = \"微信名字iagfsgfligfifg\"\r\n  //背景色块 #b9cfeb\r\n  ctx.save();\r\n  ctx.beginPath()//开始创建一个路径\r\n  this.roundRect(ctx, 0*wpx, 0*wpx,this.data.canvas.width/dpr,this.data.canvas.height/dpr, 10,wpx)//圆角\r\n  ctx.fillStyle='#74b9ff'\r\n  ctx.fillRect(0*wpx, 0*wpx,this.data.canvas.width*wpx,this.data.canvas.height*wpx)\r\n  ctx.clip()//裁剪\r\n  ctx.closePath();\r\n  ctx.restore();\r\n  // 上色块 \r\n  // ctx.save();\r\n  // ctx.beginPath()//开始创建一个路径\r\n  // this.roundRect(ctx, 8*wpx, 7*wpx,this.data.canvas.width/dpr*0.94,this.data.canvas.height/dpr*0.05, 5,wpx)//圆角\r\n  // ctx.fillStyle='#74b9ff'\r\n  // ctx.fillRect(0*wpx, 0*wpx,this.data.canvas.width*wpx,this.data.canvas.height*wpx)\r\n  // ctx.clip()//裁剪\r\n  // ctx.closePath();\r\n  // ctx.restore();\r\n  ctx.fillStyle='white';\r\n  ctx.font=String(12*wpx)+'px Arial';\r\n  ctx.fillText(\"16种人格社交指南\",14*wpx,28*wpx);\r\n  ctx.font=String(10*wpx)+'px Arial';\r\n  ctx.fillText(\"—— 你是哪一种人格？\",116*wpx,28*wpx);\r\n  //微信名字\r\n  // ctx.save();\r\n  // ctx.fillStyle='white';\r\n  // ctx.textAlign='center'\r\n  // ctx.font=String(12*wpx)+'px Arial';\r\n  // ctx.fillText(wxname,this.data.canvas.width/dpr*0.5,44*wpx);\r\n  // ctx.restore();\r\n  //中色块 背景\r\n  ctx.save();\r\n  ctx.beginPath()//开始创建一个路径\r\n  this.roundRect(ctx, 8*wpx, 45*wpx,this.data.canvas.width/dpr*0.94,this.data.canvas.height/dpr*0.29, 5,wpx)//圆角\r\n  ctx.fillStyle='#b9cfeb'\r\n  ctx.fillRect(0*wpx, 0*wpx,this.data.canvas.width*wpx,this.data.canvas.height*wpx)\r\n  ctx.clip()//裁剪\r\n  ctx.closePath();\r\n  ctx.restore();\r\n  //中色块中 小色块\r\n  // ctx.save();\r\n  // ctx.beginPath()//开始创建一个路径\r\n  // this.roundRect(ctx, 8*wpx, 55*wpx,this.data.canvas.width/dpr*0.94,this.data.canvas.height/dpr*0.03, 2,wpx)//圆角\r\n  // ctx.fillStyle='#74b9ff'\r\n  // ctx.fillRect(0*wpx, 0*wpx,this.data.canvas.width*wpx,this.data.canvas.height*wpx)\r\n  // ctx.clip()//裁剪\r\n  // ctx.closePath();\r\n  // ctx.restore();\r\n  //小圆点 和字\r\n  // ctx.save();\r\n  // ctx.beginPath()//开始创建一个路径\r\n  // ctx.arc(20*wpx, 61*wpx, 2*wpx, 0, Math.PI * 2,false)\r\n  // ctx.clip()//裁剪\r\n  // ctx.fillStyle='white'\r\n  // ctx.fillRect(0*wpx, 0*wpx, this.data.canvas.width*wpx, this.data.canvas.height*wpx)\r\n  // ctx.closePath();\r\n  // ctx.restore();\r\n  // ctx.fillStyle='white';\r\n  // ctx.font=String(7*wpx)+'px Arial';\r\n  // ctx.fillText(\"MY PERSONALTY TYPE IS\",26*wpx,63.5*wpx);\r\n  //头像\r\n  this.drawiconurl(ctx,canvas,wpx);\r\n  //MBTI类型\r\n  ctx.fillStyle='white';\r\n  ctx.font=String(20*wpx)+'px Arial';\r\n  ctx.fillText(\"您的MBTI类型为\",40*wpx,145*wpx);\r\n  ctx.fillStyle='#FCEE98';\r\n  ctx.font=String(20*wpx)+'px Arial';\r\n  ctx.fillText(MbtiType,190*wpx,145*wpx);\r\n  //下色块 背景\r\n  ctx.save();\r\n  ctx.beginPath()//开始创建一个路径\r\n  this.roundRect(ctx, 8*wpx, 169*wpx,this.data.canvas.width/dpr*0.94,this.data.canvas.height/dpr*0.435, 5,wpx)//圆角\r\n  ctx.fillStyle='#b9cfeb'\r\n  ctx.fillRect(0*wpx, 0*wpx,this.data.canvas.width*wpx,this.data.canvas.height*wpx)\r\n  ctx.clip()//裁剪\r\n  ctx.closePath();\r\n  ctx.restore();\r\n  //下色块中 小色块\r\n  // ctx.save();\r\n  // ctx.beginPath()//开始创建一个路径\r\n  // this.roundRect(ctx, 8*wpx, 179*wpx,this.data.canvas.width/dpr*0.94,this.data.canvas.height/dpr*0.03, 2,wpx)//圆角\r\n  // ctx.fillStyle='#74b9ff'\r\n  // ctx.fillRect(0*wpx, 0*wpx,this.data.canvas.width*wpx,this.data.canvas.height*wpx)\r\n  // ctx.clip()//裁剪\r\n  // ctx.closePath();\r\n  // ctx.restore();\r\n  //小圆点 和字\r\n  // ctx.save();\r\n  // ctx.beginPath()//开始创建一个路径\r\n  // ctx.arc(20*wpx, 185*wpx, 2*wpx, 0, Math.PI * 2,false)\r\n  // ctx.clip()//裁剪\r\n  // ctx.fillStyle='white'\r\n  // ctx.fillRect(0*wpx, 0*wpx, this.data.canvas.width*wpx, this.data.canvas.height*wpx)\r\n  // ctx.closePath();\r\n  // ctx.restore();\r\n  // ctx.fillStyle='white';\r\n  // ctx.font=String(7*wpx)+'px Arial';\r\n  // ctx.fillText(\"ABOUT ME\",26*wpx,187.5*wpx);\r\n  //文本 内容\r\n  ctx.fillStyle='white';\r\n  ctx.font=String(12*wpx)+'px Arial';\r\n  //文本换行 参数：1、canvas对象，2、文本 3、距离左侧的距离 4、距离顶部的距离 5、（）6、文本的宽度\r\n  this.drawText(ctx,describe,19*wpx,190*wpx,10,227*wpx);\r\n  //底部二维码\r\n  this.draw_we_codeurl(ctx,canvas,wpx,10,352)\r\n  ctx.font=String(10*wpx)+'px Arial';\r\n  ctx.fillText(\"长按识别二维码\",55*wpx,365*wpx);\r\n  ctx.fillText(\"获取你的MBIT人格分析报告\",55*wpx,385*wpx);\r\n},\r\n//we校园图标\r\ndraw_we_codeurl(ctx,canvas,wpx,x,y){\r\n  console.log(\"drawiconurl\");\r\n  let we_iconurl = \"https://636c-cloud1-6gtqj1v4873bad50-1307814679.tcb.qcloud.la/gh_2927abcc72c9_258.jpg?sign=b685101cc1b9e449b4ae4ef0700028f2&t=1647171838\";\r\n  const headerImg = canvas.createImage();\r\n  headerImg.src = we_iconurl;\r\n  headerImg.onload = () => {\r\n    ctx.drawImage(headerImg,x*wpx,y*wpx,40*wpx,40*wpx);\r\n  };\r\n},\r\n//文本换行 参数：1、canvas对象，2、文本 3、距离左侧的距离 4、距离顶部的距离 5、6、文本的宽度\r\n  drawText: function(ctx, str, leftWidth, initHeight, titleHeight, canvasWidth) {\r\n      var lineWidth = 0;\r\n      var lastSubStrIndex = 0; //每次开始截取的字符串的索引\r\n      for (let i = 0; i < str.length; i++) {\r\n          lineWidth += ctx.measureText(str[i]).width;\r\n          if (lineWidth > canvasWidth) {\r\n              ctx.fillText(str.substring(lastSubStrIndex, i), leftWidth, initHeight); //绘制截取部分\r\n              initHeight += 20; //字体行高\r\n              lineWidth = 0;\r\n              lastSubStrIndex = i;\r\n              titleHeight += 30;\r\n          }\r\n          if (i == str.length - 1) { //绘制剩余部分\r\n              ctx.fillText(str.substring(lastSubStrIndex, i + 1), leftWidth, initHeight);\r\n          }\r\n      }\r\n      // 标题border-bottom 线距顶部距离\r\n      titleHeight = titleHeight + 10;\r\n      return titleHeight\r\n  },\r\ndrawiconurl(ctx,canvas,wpx,){\r\n  console.log(\"drawiconurl\");\r\n  let iconurl = wx.getStorageSync('args').iconUrl;\r\n  const headerImg = canvas.createImage();\r\n  headerImg.src = iconurl;\r\n  headerImg.onload = () => {\r\n    ctx.save();\r\n    ctx.beginPath()//开始创建一个路径\r\n    ctx.arc(134*wpx, 90*wpx, 26*wpx, 0, 2 * Math.PI, false)//画一个圆形裁剪区域\r\n    ctx.clip()//裁剪\r\n    ctx.fillStyle='#389e89'\r\n    ctx.fillRect(0*wpx, 0*wpx, this.data.canvas.width*wpx, this.data.canvas.height*wpx)\r\n    ctx.drawImage(headerImg,108*wpx,63*wpx,53*wpx,53*wpx);\r\n    ctx.closePath();\r\n    ctx.restore();\r\n    \r\n  }\r\n},\r\nroundRect(ctx, x, y, w, h, r,wpx) {\r\n  console.log(w);\r\n  console.log(h);\r\n  console.log(r);\r\n  // 开始绘制\r\n  ctx.beginPath()\r\n  // 因为边缘描边存在锯齿，最好指定使用 transparent 填充\r\n  ctx.setFillStyle='transparent'\r\n  ctx.setStrokeStyle='transparent'\r\n  // 绘制左上角圆弧\r\n  ctx.arc(x + r, y + r, r, Math.PI, Math.PI * 1.5,false)   \r\n  // 绘制border-top\r\n  ctx.moveTo(x + r, y)\r\n  ctx.lineTo(x + w - r, y)\r\n  ctx.lineTo(x + w, y + r)\r\n  // 绘制右上角圆弧\r\n  ctx.arc(x + w - r, y + r, r, Math.PI * 1.5, Math.PI * 2)   \r\n  // 绘制border-right\r\n  ctx.lineTo(x + w, y + h - r)\r\n  ctx.lineTo(x + w - r, y + h)\r\n  // 绘制右下角圆弧\r\n  ctx.arc(x + w - r, y + h - r, r, 0, Math.PI * 0.5)    \r\n  // 绘制border-bottom\r\n  ctx.lineTo(x + r, y + h)\r\n  ctx.lineTo(x, y + h - r)\r\n  // 绘制左下角圆弧\r\n  ctx.arc(x + r, y + h - r, r, Math.PI * 0.5, Math.PI)   \r\n  // 绘制border-left\r\n  ctx.lineTo(x, y + r)\r\n  ctx.lineTo(x + r, y)\r\n  \r\n  // ctx.fill()\r\n  // ctx.stroke()\r\n  ctx.closePath()\r\n  // 剪切\r\n  ctx.clip()\r\n},\r\n\r\n  \r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   */\r\n  onLoad: function (options) {options = this.options; this.data.dark =wx.getSystemInfoSync().theme; wx.onThemeChange(e => {console.log(e.theme);this.setdata({dark: e.theme})}); this.setdata();\r\n    const res = Array.from({length: this.data.li.length}, () => 0);\r\n    this.setdata({res})\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady: function () {\r\n    \r\n  },\r\n  //mbti处理的函数\r\n  process(res){\r\n    console.log('process');\r\n    let relu = [\r\n      [{\"1\":\"E\"},\r\n      {\"2\":\"I\"}],  //在这里\r\n      [{\"1\":\"J\"},\r\n      {\"2\":\"P\"}],\r\n      [{\"1\":\"N\",},\r\n      {\"2\": \"S\",}],\r\n      [{ \"1\": \"F\"},\r\n      {\"2\" : \"T\"}],\r\n      [{\"1\": \"T\"},\r\n      {\"2\" :\"F\"}],\r\n      [{\"1\":\"E\"},\r\n      {\"2\": \"I\"}],\r\n      [{\"1\":\"P\"},\r\n      { \"2\":\"J\"},],\r\n      [{ \"1\": \"N\"},\r\n      {\"2\": \"S\"}]]\r\n      //计算数量\r\n      let ret = []\r\n      for(var i = 0;i<relu.length;i++){\r\n        ret.push(relu[i][Number(res[i])-1])\r\n      }\r\n      let dict = {}\r\n      ret.forEach((e)=>{\r\n        if(!(dict.hasOwnProperty(e[Object.keys(e)]))){\r\n          dict[e[Object.keys(e)]] = 1\r\n        }\r\n        else{\r\n          dict[e[Object.keys(e)]] = dict[e[Object.keys(e)]] + 1\r\n        }\r\n      })\r\n      let list_type = []\r\n      //如果都只有一个\r\n     let key  = Object.keys(dict)\r\n      key.forEach((e)=>{\r\n        if(dict[e]==2){\r\n          list_type.push(e)\r\n        }\r\n        else if(dict[e]==1){\r\n          if(e==\"I\" || e==\"N\" || e==\"F\" || e==\"P\"){\r\n            list_type.push(e)\r\n          }\r\n        }\r\n      })\r\n      let all_type = [{\r\ntype:\"ISTJ\",\r\ndes:`1.传统性的思考者\r\n2.行事务实、有序、实际 、 逻辑、真实及可信赖\r\n3.十分留意且乐于任何事（工作、居家、生活均有良好组织及有序。\r\n4.照设定成效来作出决策且不畏阻挠与闲言会坚定为之。\r\n5.重视传统与忠诚。\r\n6.严肃、安静、 志与全力投入、及可被信赖获致成功。`\r\n      },{\r\ntype:\"ISFJ\",\r\ndes:`1.安静、和善、负责任且有良心。\r\n2.行事尽责投入。\r\n3.安定性高。\r\n4.愿投入、吃苦及力求精确。\r\n5.兴趣通常不在于科技方面。对细节事务有耐心\r\n6.忠诚、考虑周到、且会关切他人感受\r\n7.致力于创造有序及和谐的工作与家庭环境。`\r\n      },{\r\ntype:'INFJ',\r\ndes:`1.因为坚忍、创意及必须达成的意图而能成功\r\n2.会在工作中投注最大的努力。\r\n3.默默的、诚挚的及用心的关切他人\r\n4.因坚守原则而受敬重\r\n5.提出造福大众利益的明确远景而为人所尊敬与追随\r\n6.想了解什么能激励别人及对他人具洞察力\r\n7.光明正大且坚信其价值观。`\r\n      },{\r\ntype:'INTJ',\r\ndes:`1.固执顽固者-具有强大动力来达成目的与创意\r\n2.有宏大的愿景且能快速在众多外界事件中找出有意义的模范\r\n3.对所承负职务，具良好能力于策划工作并完成\r\n4.具怀疑心、挑剔性、独立性、果决，对专业水准及绩效要求高`\r\n},{\r\n        type:'ISTP',\r\n        des:`1.冷静旁观者—安静、预留余地、弹性及会以无偏见的好奇心与未预期原始的幽默观察与分析\r\n2.有兴趣于探索原因及效果，重视效能\r\n3.擅长于掌握问题核心及找出解决方式\r\n4.分析成事的缘由且能实时由大量资料中找出实际问题的核心`\r\n      },{\r\n type:'ISFP',\r\ndes:`1.羞怯的、安宁和善地、敏感的、亲切的、且行事谦虚。\r\n2.喜于避开争论，不对他人强加已见或价值观\r\n3.无意于领导却常是忠诚的追随者\r\n4.办事不急躁，安于现状无意于以过度的急切或努力破坏现况\r\n5.喜欢有自自己的空间及照自订的时程办事`\r\n      },{\r\n        type:\"INFP\",\r\n        des:`1.安静观察者，具理想性与对其价值观及重要之人具忠诚心\r\n2.希望在生活形态与内在价值观相吻合\r\n3.具好奇心且很快能看出机会所在。常担负开发创意的触媒者 \r\n4.除非价值观受侵犯，行事会具弹性、适应力高且承受力强\r\n5.具想了解及发展他人潜能的企图。想作太多且作事全神贯注 \r\n7.具有适应力、有弹性除非价值观受到威胁。`\r\n      },{\r\n        type:'INTP',\r\n        des:`1.安静、自持、弹性及具适应力\r\n2.特别喜爱追求理论与科学事理\r\n3.习于以逻辑及分析来解决问题—问题解决者\r\n4.最有兴趣于创意事务及特定工作，对聚会与闲聊无太大兴趣\r\n5.追求可发挥个人强烈兴趣的生涯\r\n6.追求发展对有兴趣事务之逻辑解释`\r\n      },{\r\ntype:\"ESTP\",\r\ndes:`1.擅长现场实时解决问题—解决问题者\r\n2.喜欢办事并乐于其中及过程\r\n3.倾向于喜好技术事务及运动，交结同好友人\r\n4.具适应性、容忍度、务实性；投注心力于会很快具 成效工作\r\n5.不喜欢冗长概念的解释及理论\r\n6.最专精于可操作、处理、分解或组合的真实事务`\r\n      },{\r\ntype:'ESFP',\r\ndes:`1.外向、和善、接受性、乐于分享喜乐。\r\n2.喜欢与他人一起行动且促成事件发生。\r\n3.知晓事件未来的发展并会积极参与。\r\n4.最擅长于人际相处能力及具备完备常识，很有弹性能立即 适应他人与环境。\r\n5.对生命、人、物质享受的热爱者。`\r\n      },{\r\ntype:\"ENFP\",\r\ndes:`1.即兴执行者。\r\n2.几乎能达成所有有兴趣的事。\r\n3.对难题很快就有对策并能对有困难的人施予援手。\r\n4.依赖能改善的能力而无须预作规划准备。\r\n5.为达目的常能找出强制自己为之的理由。\r\n6.充满热忱、活力充沛、聪明的、富想象力的，视生命充满机会但期能得自他人肯定与支持`\r\n      },{\r\n        type:\"ENTP\",\r\n        des:`1.反应快、聪明。\r\n2.具激励伙伴、敏捷及直言讳专长。\r\n3.会为了有趣对问题的两面加予争辩。\r\n4.对解决新及挑战性的问题富有策略，但会轻忽或厌烦经常的任务与细节。\r\n5.兴趣多元，易倾向于转移至新生的兴趣。\r\n6.对所想要的会有技巧地找出逻辑的理由。`\r\n      },{\r\n        type:\"ESTJ\",\r\n        des:`1 具决断力、关注细节且很快作出决策—优秀行政者\r\n2.不喜欢抽象理论；最喜欢学习可立即运用事理。\r\n3.喜好组织与管理活动且专注以最有效率方式行事以达致成效。\r\n4.务实、真实、事实倾向，具企业或技术天份。\r\n5.会忽略他人感受。\r\n6.喜作领导者或企业主管`\r\n      },{\r\n        type:\"ESFJ\",\r\ndes:`1.诚挚、爱说话、合作性高、受欢迎、光明正大的—天生的合作者及活跃的组织成员。\r\n2.重和谐且长于创造和谐。\r\n3.常作对他人有益的事。\r\n4.给予鼓励及称许会有更佳工作成效。\r\n5.对直接及有形影响人们生活的事情感兴趣。\r\n6.喜欢与他人共事去精确且准时地完成工作`\r\n      },{\r\n        type:\"ENFJ\",\r\ndes:`1.热忱、负责任的具能鼓励他人的领导风格。\r\n2.对别人所想会表达真正关切并切实用心去处理。\r\n3.能技巧性地带领团体讨论或演示文稿提案。\r\n4.爱交际、受欢迎及富同情心。\r\n5.对夸奖及批评很在意。\r\n6.喜欢带领别人且能使别人或团体发挥潜能`\r\n      },{\r\n        type:\"ENTJ\",\r\ndes:`1.坦诚、具有决策力的活动领导者。\r\n2.长于发展与实施广泛的系统以解决组织的问题。\r\n3.专精于具内涵与智能的谈话如对公众演讲。\r\n4.乐于经常吸收新知识且能广开信息管道。\r\n5.容易生过度自信，会强于表达自已创见。\r\n6.喜于目标策划及目标设定`\r\n      },\r\n      ]\r\n      all_type.forEach((e)=>{\r\n        //list_type:[\"p\",\"n\",\"t\",\"i\"]\r\n        list_type = list_type.sort()\r\n        let t = e.type.split(\"\").sort()\r\n        if(list_type.join(\"\")===t.join(\"\")){\r\n          this.setdata({MbtiType:e.type,describe:e.des})\r\n          this.initcanvas(e.type,e.des)\r\n          return -1\r\n        }\r\n      })\r\n      //存数据库\r\n      let username =wx.getStorageSync('args').username\r\n      let School = wx.getStorageSync('args').school\r\n      db.collection('MBTI-Test').add({\r\n        data:{\r\n          username:username,\r\n          School:School,\r\n          Time:new Date(),\r\n          Type:this.data.MbtiType,\r\n          use_Time:this.data.use_Time  //用时毫秒\r\n        },\r\n        success(res){\r\n          console.log(res)\r\n        }\r\n      })\r\n  },\r\n  share(e){\r\n    let that = this;\r\n    let w = wx.getSystemInfoSync().windowWidth/375\r\n    let args = wx.getStorageSync('args');\r\n    wx.showLoading({\r\n      title: '加载中',\r\n    })\r\n    wx.canvasToTempFilePath({\r\n      canvas:that.data.canvas,\r\n      width:that.data.canvasWidth,\r\n      height:that.data.canvasHeight,\r\n      destHeight:that.data.canvasHeight*4,\r\n      destWidth:that.data.canvasWidth*4,\r\n      quality:1,\r\n        success:function(res){\r\n          let url = res.tempFilePath\r\n          console.log(url)\r\n          wx.saveImageToPhotosAlbum({\r\n            // 下载图片\r\n            filePath: url,\r\n            success: function (e) {\r\n              console.log(e)\r\n              wx.showToast({\r\n                title: '二维码已保存成功',\r\n                icon: 'success',\r\n              })\r\n            },\r\n          })\r\n\r\n          // wx.downloadFile({\r\n          //   url: url,\r\n          //   success: (res) => {\r\n          //     console.log( res.tempFilePath)\r\n          //     wx.showShareImageMenu({\r\n          //       path: res.tempFilePath\r\n          //     })\r\n          //     wx.hideLoading()\r\n          //   }\r\n          // })\r\n        }\r\n    })\r\n\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow: function () {\r\n    \r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面隐藏\r\n   */\r\n  onHide: function () {\r\n    \r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面卸载\r\n   */\r\n  onUnload: function () {\r\n    \r\n  },\r\n\r\n  /**\r\n   * 页面相关事件处理函数--监听用户下拉动作\r\n   */\r\n  onPullDownRefresh: function () {\r\n    \r\n  },\r\n\r\n  /**\r\n   * 页面上拉触底事件的处理函数\r\n   */\r\n  onReachBottom: function () {\r\n    \r\n  },\r\n\r\n  /**\r\n   * 用户点击右上角分享\r\n   */\r\n  onShareAppMessage: function () {\r\n    \r\n  }\r\n})\n}\n  window.exports = runCode;\n  "],"names":[],"sourceRoot":""}